/**
 * 省份名称 -> 行政区划 adcode（六位），用于加载省份 GeoJSON 地图
 * 仅从本地 /geo/{adcode}.json 加载，支持离线展示（不访问在线数据）
 */
export const PROVINCE_ADCODE: Record<string, string> = {
  北京市: '110000',
  北京: '110000',
  天津市: '120000',
  天津: '120000',
  河北省: '130000',
  河北: '130000',
  山西省: '140000',
  山西: '140000',
  内蒙古自治区: '150000',
  内蒙古: '150000',
  辽宁省: '210000',
  辽宁: '210000',
  吉林省: '220000',
  吉林: '220000',
  黑龙江省: '230000',
  黑龙江: '230000',
  上海市: '310000',
  上海: '310000',
  江苏省: '320000',
  江苏: '320000',
  浙江省: '330000',
  浙江: '330000',
  安徽省: '340000',
  安徽: '340000',
  福建省: '350000',
  福建: '350000',
  江西省: '360000',
  江西: '360000',
  山东省: '370000',
  山东: '370000',
  河南省: '410000',
  河南: '410000',
  湖北省: '420000',
  湖北: '420000',
  湖南省: '430000',
  湖南: '430000',
  广东省: '440000',
  广东: '440000',
  广西壮族自治区: '450000',
  广西: '450000',
  海南省: '460000',
  海南: '460000',
  重庆市: '500000',
  重庆: '500000',
  四川省: '510000',
  四川: '510000',
  贵州省: '520000',
  贵州: '520000',
  云南省: '530000',
  云南: '530000',
  西藏自治区: '540000',
  西藏: '540000',
  陕西省: '610000',
  陕西: '610000',
  甘肃省: '620000',
  甘肃: '620000',
  青海省: '630000',
  青海: '630000',
  宁夏回族自治区: '640000',
  宁夏: '640000',
  新疆维吾尔自治区: '650000',
  新疆: '650000',
  台湾省: '710000',
  台湾: '710000',
  香港特别行政区: '810000',
  香港: '810000',
  澳门特别行政区: '820000',
  澳门: '820000',
};

/** 省份名称（短名/全名）→ 地图中心 [经度, 纬度]，用于流动线 */
export const PROVINCE_CENTER: Record<string, [number, number]> = {
  北京: [116.4, 39.9], 北京市: [116.4, 39.9],
  天津: [117.2, 39.13], 天津市: [117.2, 39.13],
  河北: [114.48, 38.03], 河北省: [114.48, 38.03],
  山西: [112.55, 37.87], 山西省: [112.55, 37.87],
  内蒙古: [111.65, 40.82], 内蒙古自治区: [111.65, 40.82],
  辽宁: [123.43, 41.8], 辽宁省: [123.43, 41.8],
  吉林: [125.32, 43.88], 吉林省: [125.32, 43.88],
  黑龙江: [126.63, 45.75], 黑龙江省: [126.63, 45.75],
  上海: [121.47, 31.23], 上海市: [121.47, 31.23],
  江苏: [118.8, 32.06], 江苏省: [118.8, 32.06],
  浙江: [120.15, 30.28], 浙江省: [120.15, 30.28],
  安徽: [117.23, 31.82], 安徽省: [117.23, 31.82],
  福建: [119.3, 26.08], 福建省: [119.3, 26.08],
  江西: [115.86, 28.68], 江西省: [115.86, 28.68],
  山东: [117.02, 36.65], 山东省: [117.02, 36.65],
  河南: [113.65, 34.76], 河南省: [113.65, 34.76],
  湖北: [114.31, 30.52], 湖北省: [114.31, 30.52],
  湖南: [112.98, 28.11], 湖南省: [112.98, 28.11],
  广东: [113.26, 23.13], 广东省: [113.26, 23.13],
  广西: [108.37, 22.82], 广西壮族自治区: [108.37, 22.82],
  海南: [110.32, 20.03], 海南省: [110.32, 20.03],
  重庆: [106.58, 29.56], 重庆市: [106.58, 29.56],
  四川: [104.06, 30.67], 四川省: [104.06, 30.67],
  贵州: [106.71, 26.57], 贵州省: [106.71, 26.57],
  云南: [102.71, 25.04], 云南省: [102.71, 25.04],
  西藏: [91.13, 29.65], 西藏自治区: [91.13, 29.65],
  陕西: [108.93, 34.27], 陕西省: [108.93, 34.27],
  甘肃: [103.82, 36.06], 甘肃省: [103.82, 36.06],
  青海: [101.78, 36.62], 青海省: [101.78, 36.62],
  宁夏: [106.27, 38.47], 宁夏回族自治区: [106.27, 38.47],
  新疆: [87.62, 43.79], 新疆维吾尔自治区: [87.62, 43.79],
  台湾: [121.5, 25.04], 台湾省: [121.5, 25.04],
  香港: [114.17, 22.32], 香港特别行政区: [114.17, 22.32],
  澳门: [113.55, 22.19], 澳门特别行政区: [113.55, 22.19],
};

/**
 * 获取省份 adcode，未找到返回空字符串
 */
export function getProvinceAdcode(provinceName: string): string {
  const trimmed = provinceName?.trim() ?? '';
  return PROVINCE_ADCODE[trimmed] ?? '';
}

/**
 * 获取省份在地图上的中心坐标 [经度, 纬度]，用于流动线；未找到返回 undefined
 */
export function getProvinceCenter(provinceName: string): [number, number] | undefined {
  const trimmed = provinceName?.trim() ?? '';
  return PROVINCE_CENTER[trimmed];
}

/**
 * 从本地 /geo/{adcode}.json 加载省份 GeoJSON，仅支持离线（不访问在线数据）
 */
export function fetchProvinceGeoJson(adcode: string): Promise<unknown> {
  const url = `/littlesmall/geo/${adcode}.json`;
  return fetch(url).then((res) => {
    if (!res.ok) throw new Error(`geo not found: ${adcode}`);
    return res.json();
  });
}
